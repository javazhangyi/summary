6-数据同步
   如何保证数据高可靠
    数据尽量少丢失：RDB 和 AOF
    服务尽量少中断：数据副本冗余
  主从库间如何进行第一次同步
    通过replicaof（5.0之前通过slaveof）（relicaof ip port）
  第一次同步的三个阶段
    第一阶段，建立连接，协同同步（从节点执行saveOf 主节点ip port），然后保存组节点保存的信息
    第二阶段，接受主节点的RDB，同时自己的信息（主节点执行bgsave）
    第三阶段，主节点发送新写入的命令给从节点（主节点见replication buffer 发送给从节点）
    有什么问题：生成RDB 和传输RDB，主节点压力比较大
    解决方案：主-从-从，将主库的压力，分散的从库上，这个过程叫做基于常连接的命令传播
      存在的问题：网络断连
    主从网络断连怎么办：采用增量复制继续同步，在网络断连期间，主库收到的命令，同步给从库
    如何实现：通过repl-backlog-buffer 环形缓存区，主库记录自己写到那个位置，从库记录自己读到哪个位置
    造成的问题：从数据读的太慢，数据覆盖造成，数据不一致
    解决方案：扩大缓冲区大小，或者切片集群

  主从复制的模式
    全量复制（主-从）
    基于长连接命令长度（主-从-从）
    以及增量复制（主要是节点网络断连的清情况）

主从全量同步使用RDB而不使用AOF的原因：
  RDB 比AOF 文件小，减小网络压力
  RDB 比AOF 恢复快
  使用AOF，那就必须开启刷盘策略，会影响主机的性能

  主从同步原理
    全量同步
    长连接同步
    增量同步


按照惯例，我给你提一个小问题。这节课，我提到，主从库间的数据复制同步使用的是 RDB 文件，前面我们学习过，AOF 记录的操作命令更全，相比于 RDB 丢失的数据更少。那么，为什么主从库间的复制不使用 AOF 呢？
    RDB 文件更小，恢复更快，AOF 对redis影响更大

    repl_backlog_buffer：环形缓冲区，用于记录主节点的命令，在增量同步的时候时候，避免全量同步
    replication buffer：从节点缓冲区，主节点发送到从节点的缓冲区，从库读取的太慢，可能到时，全量同步，进而导致复制风暴
